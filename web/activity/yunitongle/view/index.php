<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>愚你同乐，礼惠全服</title>
<script type="text/javascript" src="web/activity/yunitongle/js/jquery-2.1.1.min.js"></script>
<style type="text/css">
    
body {
	               margin: 0 auto;
	               padding: 0;
	               text-align: center;
	               -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
a {
	               text-decoration: none;
                   -webkit-tap-highlight-color: rgba(0,0,0,0);
}
td  {
	               border: solid 1px;
	               padding: 10px;
}


.float_left {
	               float: left;
}
.float_right {
	               float: right;
}
.clear {
	               clear: both;
}
.relative {
	               position: relative;
}
.absolute {
	               position: absolute;
}
.tab {
	               width: 189px; 
	               height: 66px;
	               margin-top:8px;
	               line-height: 66px;
	               display: inline-block;
                   color: #ecac64;
                   font-size: 32px;
}

</style>
</head>
<body>
    <div id="main" class="relative" style="width: 1280px;height: 800px; margin: 0 auto; background: url(web/activity/yunitongle/image/bg.jpg);">
        <div id="header" class="relative" style="height: 74px;background: url(web/activity/image/head_ddz.png);  z-index: 1;">
            <a id="tab_2" class="tab float_right" href="javaScript:;" style="background: url(web/activity/image/caidan_leave.png);margin-right: 190px;">活动介绍</a>
            <a id="tab_1" class="tab float_right" href="javaScript:;" style="background: url(web/activity/image/caidan_on.png);margin-right: 15px;">活动</a>
        </div>
        <div id="content" class="relative" style=" width: 1280px; height: 726px;">
            <div id="table_1" >
                <img class="absolute" src="web/activity/yunitongle/image/yuren11_n.png" style="left: 30px; top: 168px;">
                <div class="absolute" style="background: url(web/activity/yunitongle/image/yuren13_n.png); width: 204px; height: 71px; left: 62px; top: 50px;">
                    <div id="power" style="height: 71px; line-height: 71px; color: #fff; font-size: 38px;">体力:<?php echo $tili?></div>
                </div>
                <div class="absolute" style="background: url(web/activity/yunitongle/image/yuren12_n.png); width: 414px; height: 274px; left: 470px; top: -74px; z-index: 0;">
                    <div id="notification" style="background: url(web/activity/yunitongle/image/yuren14_n.png); width: 425px; height: 187px; margin: 115px 0 0 -6px; display: none;">
                        <div id="buzhong" class="relative" style="display: none">
                            <img class="absolute" src="web/activity/yunitongle/image/yuren18_n.png" style="left: 0; top: -20px;">
                            <img class="absolute" src="web/activity/yunitongle/image/yuren19_n.png" style="left: 135px; top: 32px;">
                            <div id="buchang" class="absolute" style="width: 195px; height: 53px; left: 200px; top: 90px;"></div>
                        </div>
                        <div id="zhong" class="relative" style="display: none;">
                            <img class="absolute" src="web/activity/yunitongle/image/yuren15_n.png" style="left: -10px; top: -8px;">
                            <img class="absolute" src="web/activity/yunitongle/image/yuren16_n.png" style="left: 135px; top: 32px;">
                            <div id="bonus" class="absolute" style="width: 195px; height: 53px; left: 200px; top: 90px;"></div>
                        </div>
                    </div>
                </div>
                <div class="absolute" style="left: 385px; top: 293px; text-align: left;">
                    <div class="relative" style="width: 197px; height: 225px; display: inline-block">
                        <img id="yuren1" class="absolute egg" style="bottom: 0;" src="web/activity/yunitongle/image/yuren1.png">
                        <div class="absolute" style="width: 152px; height: 54px; left: 5px; bottom: -20px; background: url(web/activity/yunitongle/image/yuren6_n.png); text-align: center; line-height: 54px; color: #fff; font-size: 21px;">
                                                        需要体力:100
                        </div>
                    </div><div class="relative" style="width: 197px; height: 225px; display: inline-block">
                        <img id="yuren2" class="absolute egg" style="bottom: 0;" src="web/activity/yunitongle/image/yuren2.png">
                        <div class="absolute" style="width: 152px; height: 54px; left: 5px; bottom: -20px; background: url(web/activity/yunitongle/image/yuren6_n.png); text-align: center; line-height: 54px; color: #fff; font-size: 21px;">
                                                        需要体力:80
                        </div>
                    </div><div class="relative" style="width: 197px; height: 225px; display: inline-block">
                        <img id="yuren3" class="absolute egg" style="bottom: 0;" src="web/activity/yunitongle/image/yuren3.png">
                        <div class="absolute" style="width: 152px; height: 54px; left: 5px; bottom: -20px; background: url(web/activity/yunitongle/image/yuren6_n.png); text-align: center; line-height: 54px; color: #fff; font-size: 21px;">
                                                        需要体力:30
                        </div>
                    </div><div class="relative" style="width: 197px; height: 225px; display: inline-block">
                        <img id="yuren4" class="absolute egg" style="bottom: 0;" src="web/activity/yunitongle/image/yuren4.png">
                        <div class="absolute" style="width: 152px; height: 54px; left: 5px; bottom: -20px; background: url(web/activity/yunitongle/image/yuren6_n.png); text-align: center; line-height: 54px; color: #fff; font-size: 21px;">
                                                        需要体力:6    
                        </div>
                    </div>
                </div>
                <img id="hammer" class="absolute" style="left: 500px; top:200px; display: none;" src="web/activity/yunitongle/image/yuren20-0_n.png">
            </div>
            <!-- 活动说明 -->
            <div id="table_2" style="display: none;">
                <div style="color: #fff; width: 1000px; text-align: left; margin: 100px auto; font-size: 36px;">
                    <div style="padding: 10px;">活动内容:</div>
                    <div style="padding: 10px;">1.充值一元可获得一体力，消耗体力砸彩蛋</div>
                    <div style="padding: 10px;">2.消耗体力越高砸蛋，可能获得的奖品价值越高</div>
                    <div style="padding: 10px;">3.每日零点体力清零，每天仅可砸两次</div>
                </div>
            </div>
        </div>
        <div id="caution" class="absolute" style="left:50%;top:45%; z-index: 10; margin: -105px 0 0 -275px; display: none;">
        	<div class="relative">
		        <div style="background-color:#000; border: solid 4px #FFD700; border-radius:30px; width:550px; height:200px; opacity:0.8;"></div>
		        <span id="cmessage" class="absolute" style="color:#FFF; line-height:105px; font-size: 30px; z-index:100; left:0; top:0; width:550px; height:200px; line-height:200px; margin: 4px;"></span>
	       	</div>
       	</div>
    </div>
</body>
<script type="text/javascript">
$(this).ready(function(){
	//头部卡片切换
	$(".tab").click(function(){
		var now_tab = $(this).attr("id").replace("tab_","");
		$("#table_1").hide();
		$("#table_2").hide();
		$("#tab_1").css("background-image","url(web/activity/image/caidan_leave.png)");
		$("#tab_2").css("background-image","url(web/activity/image/caidan_leave.png)");
		if(now_tab==1){
			$("#tab_1").css("background-image","url(web/activity/image/caidan_on.png)");
			$("#table_1").show();
		}else {
			$("#tab_2").css("background-image","url(web/activity/image/caidan_on.png)");
			$("#table_2").show();
		}
	});
	
	//用图片替代数字
	function to_img (number){
		var number=number;
		var imgs=['0.png','1.png','2.png','3.png','4.png','5.png','6.png','7.png','8.png','9.png'];
		var ns='0123456789'.split('');
		var output='';
		var number=number+'';
		for(var i=0;i<number.length;i++){
			for(var j=0;j<ns.length;j++){
				if(number[i]==ns[j]){
				output+="<img src=web/activity/yunitongle/image/"+imgs[j]+" style='margin: 0 -4px;'/>";
				break;
		   		}
		  	}
		}
		return output;
	}


	
	//margin: 0 -4px;
    var lingquNum = <?php echo $lingquNum ? $lingquNum : 0?>;
    var tili      = <?php echo $tili ? $tili : 0?>;

	function tapEgg () {
        $(".egg").mouseup(function (){
        	var tapid = $(this).attr("id");
    		var tapType = tapid.replace("yuren","");

    		switch (tapType) {
                case '1':
                    var need = 100;
                    break;
                case '2':
                	var need = 80;
                    break;
                case '3':
                    var need = 30;
                    break;
                case '4':
                    var need = 6;
                    break;
            }
            
            if (lingquNum<=1){
            	if (tili>=need){
            	    $.ajax({
            	        type: "POST",
            	        url:"<?php echo $url ?>?m=activity&p=dispath&fpath=yunitongle&mtkey=<?php echo $mtkey?>&act=set",
                        dataType: 'json',
                        data:"gameid=<?php echo $gameid?>"
            				+"&mid=<?php echo $mid?>"
            				+"&sid=<?php echo $sid?>"
            				+"&cid=<?php echo $cid?>"
            				+"&pid=<?php echo $pid?>"
            				+"&ctype=<?php echo $ctype?>"
            				+"&tapType="+tapType,
                        success:function(json){
                            
                            $(".egg").unbind('mouseup').css("cursor","default");
                    		knock(tapid);
                    		
                            var status  = json.status;
                            var prize   = json.prize;
                            var power    = json.tili;
                            lingquNum   = json.lingquNum;
                            tili        = json.tili;
                            var famoney = json.famoney;

                            if (status == 1){
                                $("#power").text('体力:'+power);
                                setTimeout(function (){
                                    notification(prize,famoney);
                                },500);
                                setTimeout(function (){
                                    tapEgg();
                                },3000);
                            }else {
            					$("#cmessage").text("出错了！("+status+")");
                            	$("#caution").stop(true,true).fadeIn(2000);
                            	
                            	setTimeout(function(){
        	    					$("#caution").stop(true,true).fadeOut(2000);
        	    					tapEgg();
            			        },3000);
                			}
                        }
            		});
            	}else {
            		$("#cmessage").text("小丑体力不足,快去商城充值获得体力吧!");
                	$("#caution").stop(true,true).fadeIn(1000);
                	
                	setTimeout(function(){
    					$("#caution").stop(true,true).fadeOut(1000);
			        },3000);
            	}
            }else {
            	$("#cmessage").text("砸蛋次数达到上限啦！");
            	$("#caution").stop(true,true).fadeIn(1000);
            	
            	setTimeout(function(){
					$("#caution").stop(true,true).fadeOut(1000);
		        },3000);
            }
    	});
	}
	
	function knock(tapid){
		
		switch (tapid){
        	case 'yuren1':
        		$("#hammer").css({"left":"460px","top":"190px"});
        		break;
        	case 'yuren2':
        		$("#hammer").css({"left":"657px","top":"190px"});
        		break;
        	case 'yuren3':
        		$("#hammer").css({"left":"854px","top":"190px"});
        		break;
        	case 'yuren4':
        		$("#hammer").css({"left":"1051px","top":"190px"});
        		break;
        }

        $("#hammer").attr('src','web/activity/yunitongle/image/yuren20-0_n.png');
        $("#hammer").show();

		var i = 0;
		var _interval;
		function funa(){
			if (i<=3){
			    $("#hammer").attr('src','web/activity/yunitongle/image/yuren20-'+i+'_n.png');
			}
			i++;
			if(i>=5){
			    i = 0;
			    clearInterval(_interval);
			    $("#"+tapid).attr("src",'web/activity/yunitongle/image/'+tapid+'_n.png');
			}
		}
		//循环执行，每隔0.1秒钟执行一次
		_interval = setInterval(funa, 100);
		
		setTimeout(function (){
			  $("#hammer").hide()
		    },2000);
	    setTimeout(function (){
	    	  $("#"+tapid).attr("src",'web/activity/yunitongle/image/'+tapid+'.png');
		    },3000);
    };

    function notification (prize,money){
        
        if (prize=='get'){
            $("#zhong").show();
            var bonus_money	= to_img(money);
            $("#bonus").html(bonus_money);
        }else {
            $("#buzhong").show();
            var buchang_money	= to_img(money);
            $("#buchang").html(buchang_money);
        }
        
        $("#notification").show();

        setTimeout(function (){
        	$("#zhong").hide();
        	$("#buzhong").hide();
        	$("#notification").hide();
        },2400);
    };
	
	tapEgg();
});
</script>
</html>